checkpoint path: checkpoints/ic15_resnet50_bs_8_ep_30_pretrain_ic17
init lr: 0.00010000
schedule:  [10, 20]
Using pretrained model.

Epoch: [1 | 30] LR: 0.000100
/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/functional.py:2416: UserWarning: nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.
  warnings.warn("nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.")
/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/functional.py:2506: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  "See the documentation of nn.Upsample for details.".format(mode))
(1/157) Batch: 5.259s | TOTAL: 0min | ETA: 14min | Loss: 0.1863 | Acc_t:  0.9106 | IOU_t:  0.8544 | IOU_k:  0.8464
(21/157) Batch: 1.271s | TOTAL: 0min | ETA: 3min | Loss: 0.2516 | Acc_t:  0.8757 | IOU_t:  0.8196 | IOU_k:  0.8335
(41/157) Batch: 1.172s | TOTAL: 1min | ETA: 2min | Loss: 0.2335 | Acc_t:  0.8922 | IOU_t:  0.8223 | IOU_k:  0.8410
(61/157) Batch: 1.142s | TOTAL: 1min | ETA: 2min | Loss: 0.2420 | Acc_t:  0.8963 | IOU_t:  0.8134 | IOU_k:  0.8426
(81/157) Batch: 1.128s | TOTAL: 2min | ETA: 1min | Loss: 0.2397 | Acc_t:  0.8914 | IOU_t:  0.8132 | IOU_k:  0.8389
(101/157) Batch: 1.118s | TOTAL: 2min | ETA: 1min | Loss: 0.2269 | Acc_t:  0.8933 | IOU_t:  0.8192 | IOU_k:  0.8387
(121/157) Batch: 1.111s | TOTAL: 2min | ETA: 1min | Loss: 0.2314 | Acc_t:  0.8889 | IOU_t:  0.8170 | IOU_k:  0.8352
(141/157) Batch: 1.105s | TOTAL: 3min | ETA: 0min | Loss: 0.2272 | Acc_t:  0.8916 | IOU_t:  0.8211 | IOU_k:  0.8370

Epoch: [2 | 30] LR: 0.000100
(1/157) Batch: 2.513s | TOTAL: 0min | ETA: 7min | Loss: 0.1061 | Acc_t:  0.9422 | IOU_t:  0.8925 | IOU_k:  0.8468
(21/157) Batch: 1.134s | TOTAL: 0min | ETA: 3min | Loss: 0.2332 | Acc_t:  0.8751 | IOU_t:  0.8170 | IOU_k:  0.8236
(41/157) Batch: 1.103s | TOTAL: 1min | ETA: 2min | Loss: 0.2269 | Acc_t:  0.8767 | IOU_t:  0.8234 | IOU_k:  0.8297
(61/157) Batch: 1.094s | TOTAL: 1min | ETA: 2min | Loss: 0.2296 | Acc_t:  0.8851 | IOU_t:  0.8246 | IOU_k:  0.8376
(81/157) Batch: 1.091s | TOTAL: 1min | ETA: 1min | Loss: 0.2237 | Acc_t:  0.8916 | IOU_t:  0.8274 | IOU_k:  0.8404
(101/157) Batch: 1.091s | TOTAL: 2min | ETA: 1min | Loss: 0.2238 | Acc_t:  0.8894 | IOU_t:  0.8283 | IOU_k:  0.8383
(121/157) Batch: 1.088s | TOTAL: 2min | ETA: 1min | Loss: 0.2272 | Acc_t:  0.8885 | IOU_t:  0.8287 | IOU_k:  0.8382
(141/157) Batch: 1.085s | TOTAL: 3min | ETA: 0min | Loss: 0.2227 | Acc_t:  0.8920 | IOU_t:  0.8318 | IOU_k:  0.8399

Epoch: [3 | 30] LR: 0.000100
(1/157) Batch: 2.815s | TOTAL: 0min | ETA: 7min | Loss: 0.2022 | Acc_t:  0.9288 | IOU_t:  0.8518 | IOU_k:  0.8426
(21/157) Batch: 1.161s | TOTAL: 0min | ETA: 3min | Loss: 0.2581 | Acc_t:  0.8880 | IOU_t:  0.8304 | IOU_k:  0.8370
(41/157) Batch: 1.122s | TOTAL: 1min | ETA: 2min | Loss: 0.2249 | Acc_t:  0.8954 | IOU_t:  0.8439 | IOU_k:  0.8349
(61/157) Batch: 1.109s | TOTAL: 1min | ETA: 2min | Loss: 0.2171 | Acc_t:  0.8972 | IOU_t:  0.8449 | IOU_k:  0.8355
(81/157) Batch: 1.102s | TOTAL: 1min | ETA: 1min | Loss: 0.2184 | Acc_t:  0.8963 | IOU_t:  0.8403 | IOU_k:  0.8364
(101/157) Batch: 1.097s | TOTAL: 2min | ETA: 1min | Loss: 0.2187 | Acc_t:  0.8977 | IOU_t:  0.8399 | IOU_k:  0.8358
(121/157) Batch: 1.095s | TOTAL: 2min | ETA: 1min | Loss: 0.2130 | Acc_t:  0.9010 | IOU_t:  0.8424 | IOU_k:  0.8375
(141/157) Batch: 1.095s | TOTAL: 3min | ETA: 0min | Loss: 0.2070 | Acc_t:  0.9030 | IOU_t:  0.8458 | IOU_k:  0.8386

Epoch: [4 | 30] LR: 0.000100
(1/157) Batch: 2.490s | TOTAL: 0min | ETA: 7min | Loss: 0.1437 | Acc_t:  0.8827 | IOU_t:  0.8444 | IOU_k:  0.7816
(21/157) Batch: 1.151s | TOTAL: 0min | ETA: 3min | Loss: 0.2405 | Acc_t:  0.8997 | IOU_t:  0.8245 | IOU_k:  0.8478
(41/157) Batch: 1.117s | TOTAL: 1min | ETA: 2min | Loss: 0.2218 | Acc_t:  0.9054 | IOU_t:  0.8394 | IOU_k:  0.8408
(61/157) Batch: 1.102s | TOTAL: 1min | ETA: 2min | Loss: 0.2208 | Acc_t:  0.9000 | IOU_t:  0.8358 | IOU_k:  0.8387
(81/157) Batch: 1.096s | TOTAL: 1min | ETA: 1min | Loss: 0.2167 | Acc_t:  0.9011 | IOU_t:  0.8389 | IOU_k:  0.8375
(101/157) Batch: 1.096s | TOTAL: 2min | ETA: 1min | Loss: 0.2146 | Acc_t:  0.9018 | IOU_t:  0.8408 | IOU_k:  0.8362
(121/157) Batch: 1.094s | TOTAL: 2min | ETA: 1min | Loss: 0.2086 | Acc_t:  0.8960 | IOU_t:  0.8365 | IOU_k:  0.8328
(141/157) Batch: 1.093s | TOTAL: 3min | ETA: 0min | Loss: 0.2012 | Acc_t:  0.8953 | IOU_t:  0.8361 | IOU_k:  0.8319

Epoch: [5 | 30] LR: 0.000100
(1/157) Batch: 2.274s | TOTAL: 0min | ETA: 6min | Loss: 0.1160 | Acc_t:  0.9405 | IOU_t:  0.8656 | IOU_k:  0.8379
(21/157) Batch: 1.139s | TOTAL: 0min | ETA: 3min | Loss: 0.1924 | Acc_t:  0.9056 | IOU_t:  0.8536 | IOU_k:  0.8464
(41/157) Batch: 1.120s | TOTAL: 1min | ETA: 2min | Loss: 0.2017 | Acc_t:  0.9152 | IOU_t:  0.8535 | IOU_k:  0.8516
(61/157) Batch: 1.106s | TOTAL: 1min | ETA: 2min | Loss: 0.2113 | Acc_t:  0.9107 | IOU_t:  0.8528 | IOU_k:  0.8448
(81/157) Batch: 1.102s | TOTAL: 1min | ETA: 1min | Loss: 0.2124 | Acc_t:  0.9041 | IOU_t:  0.8487 | IOU_k:  0.8448
(101/157) Batch: 1.101s | TOTAL: 2min | ETA: 1min | Loss: 0.2075 | Acc_t:  0.9005 | IOU_t:  0.8455 | IOU_k:  0.8433
(121/157) Batch: 1.096s | TOTAL: 2min | ETA: 1min | Loss: 0.2050 | Acc_t:  0.8998 | IOU_t:  0.8444 | IOU_k:  0.8425
(141/157) Batch: 1.096s | TOTAL: 3min | ETA: 0min | Loss: 0.2001 | Acc_t:  0.9039 | IOU_t:  0.8454 | IOU_k:  0.8436

Epoch: [6 | 30] LR: 0.000100
(1/157) Batch: 2.378s | TOTAL: 0min | ETA: 6min | Loss: 0.1779 | Acc_t:  0.9220 | IOU_t:  0.8789 | IOU_k:  0.8133
(21/157) Batch: 1.155s | TOTAL: 0min | ETA: 3min | Loss: 0.2084 | Acc_t:  0.8873 | IOU_t:  0.8336 | IOU_k:  0.8351
(41/157) Batch: 1.121s | TOTAL: 1min | ETA: 2min | Loss: 0.2031 | Acc_t:  0.8860 | IOU_t:  0.8371 | IOU_k:  0.8355
(61/157) Batch: 1.107s | TOTAL: 1min | ETA: 2min | Loss: 0.2021 | Acc_t:  0.8899 | IOU_t:  0.8380 | IOU_k:  0.8388
(81/157) Batch: 1.100s | TOTAL: 1min | ETA: 1min | Loss: 0.1971 | Acc_t:  0.9004 | IOU_t:  0.8480 | IOU_k:  0.8448
(101/157) Batch: 1.099s | TOTAL: 2min | ETA: 1min | Loss: 0.1963 | Acc_t:  0.9000 | IOU_t:  0.8476 | IOU_k:  0.8445
(121/157) Batch: 1.099s | TOTAL: 2min | ETA: 1min | Loss: 0.1932 | Acc_t:  0.8985 | IOU_t:  0.8472 | IOU_k:  0.8418
(141/157) Batch: 1.095s | TOTAL: 3min | ETA: 0min | Loss: 0.1928 | Acc_t:  0.9011 | IOU_t:  0.8501 | IOU_k:  0.8432

Epoch: [7 | 30] LR: 0.000100
(1/157) Batch: 2.724s | TOTAL: 0min | ETA: 7min | Loss: 0.2364 | Acc_t:  0.9132 | IOU_t:  0.8578 | IOU_k:  0.8585
(21/157) Batch: 1.163s | TOTAL: 0min | ETA: 3min | Loss: 0.1818 | Acc_t:  0.9157 | IOU_t:  0.8577 | IOU_k:  0.8541
(41/157) Batch: 1.126s | TOTAL: 1min | ETA: 2min | Loss: 0.1872 | Acc_t:  0.9141 | IOU_t:  0.8560 | IOU_k:  0.8499
(61/157) Batch: 1.116s | TOTAL: 1min | ETA: 2min | Loss: 0.1926 | Acc_t:  0.9128 | IOU_t:  0.8583 | IOU_k:  0.8493
(81/157) Batch: 1.106s | TOTAL: 1min | ETA: 1min | Loss: 0.2058 | Acc_t:  0.9117 | IOU_t:  0.8573 | IOU_k:  0.8484
(101/157) Batch: 1.101s | TOTAL: 2min | ETA: 1min | Loss: 0.2074 | Acc_t:  0.9115 | IOU_t:  0.8552 | IOU_k:  0.8470
(121/157) Batch: 1.100s | TOTAL: 2min | ETA: 1min | Loss: 0.2072 | Acc_t:  0.9094 | IOU_t:  0.8528 | IOU_k:  0.8457
(141/157) Batch: 1.100s | TOTAL: 3min | ETA: 0min | Loss: 0.2014 | Acc_t:  0.9092 | IOU_t:  0.8533 | IOU_k:  0.8458

Epoch: [8 | 30] LR: 0.000100
(1/157) Batch: 2.738s | TOTAL: 0min | ETA: 7min | Loss: 0.2141 | Acc_t:  0.9540 | IOU_t:  0.9060 | IOU_k:  0.8679
(21/157) Batch: 1.169s | TOTAL: 0min | ETA: 3min | Loss: 0.1918 | Acc_t:  0.8719 | IOU_t:  0.8193 | IOU_k:  0.8489
(41/157) Batch: 1.134s | TOTAL: 1min | ETA: 2min | Loss: 0.1917 | Acc_t:  0.8791 | IOU_t:  0.8224 | IOU_k:  0.8473
(61/157) Batch: 1.119s | TOTAL: 1min | ETA: 2min | Loss: 0.1803 | Acc_t:  0.8964 | IOU_t:  0.8396 | IOU_k:  0.8539
(81/157) Batch: 1.114s | TOTAL: 1min | ETA: 1min | Loss: 0.1918 | Acc_t:  0.9034 | IOU_t:  0.8454 | IOU_k:  0.8591
(101/157) Batch: 1.109s | TOTAL: 2min | ETA: 1min | Loss: 0.1904 | Acc_t:  0.9038 | IOU_t:  0.8461 | IOU_k:  0.8577
(121/157) Batch: 1.104s | TOTAL: 2min | ETA: 1min | Loss: 0.1919 | Acc_t:  0.9041 | IOU_t:  0.8477 | IOU_k:  0.8551
(141/157) Batch: 1.100s | TOTAL: 3min | ETA: 0min | Loss: 0.1887 | Acc_t:  0.9066 | IOU_t:  0.8494 | IOU_k:  0.8541

Epoch: [9 | 30] LR: 0.000100
(1/157) Batch: 2.752s | TOTAL: 0min | ETA: 7min | Loss: 0.3779 | Acc_t:  0.9090 | IOU_t:  0.8459 | IOU_k:  0.8243
(21/157) Batch: 1.183s | TOTAL: 0min | ETA: 3min | Loss: 0.1958 | Acc_t:  0.9090 | IOU_t:  0.8571 | IOU_k:  0.8513
(41/157) Batch: 1.136s | TOTAL: 1min | ETA: 2min | Loss: 0.1906 | Acc_t:  0.9098 | IOU_t:  0.8609 | IOU_k:  0.8481
(61/157) Batch: 1.118s | TOTAL: 1min | ETA: 2min | Loss: 0.1934 | Acc_t:  0.9171 | IOU_t:  0.8633 | IOU_k:  0.8524
(81/157) Batch: 1.110s | TOTAL: 1min | ETA: 1min | Loss: 0.1987 | Acc_t:  0.9116 | IOU_t:  0.8587 | IOU_k:  0.8475
(101/157) Batch: 1.105s | TOTAL: 2min | ETA: 1min | Loss: 0.1981 | Acc_t:  0.9128 | IOU_t:  0.8602 | IOU_k:  0.8470
(121/157) Batch: 1.101s | TOTAL: 2min | ETA: 1min | Loss: 0.1978 | Acc_t:  0.9090 | IOU_t:  0.8561 | IOU_k:  0.8463
(141/157) Batch: 1.100s | TOTAL: 3min | ETA: 0min | Loss: 0.1972 | Acc_t:  0.9110 | IOU_t:  0.8560 | IOU_k:  0.8475

Epoch: [10 | 30] LR: 0.000100
(1/157) Batch: 2.425s | TOTAL: 0min | ETA: 6min | Loss: 0.1014 | Acc_t:  0.9291 | IOU_t:  0.8891 | IOU_k:  0.8418
(21/157) Batch: 1.148s | TOTAL: 0min | ETA: 3min | Loss: 0.1972 | Acc_t:  0.8984 | IOU_t:  0.8507 | IOU_k:  0.8396
(41/157) Batch: 1.125s | TOTAL: 1min | ETA: 2min | Loss: 0.1890 | Acc_t:  0.9027 | IOU_t:  0.8492 | IOU_k:  0.8452
(61/157) Batch: 1.116s | TOTAL: 1min | ETA: 2min | Loss: 0.2005 | Acc_t:  0.8995 | IOU_t:  0.8459 | IOU_k:  0.8428
(81/157) Batch: 1.109s | TOTAL: 1min | ETA: 1min | Loss: 0.1959 | Acc_t:  0.9071 | IOU_t:  0.8514 | IOU_k:  0.8486
(101/157) Batch: 1.106s | TOTAL: 2min | ETA: 1min | Loss: 0.1973 | Acc_t:  0.9087 | IOU_t:  0.8532 | IOU_k:  0.8488
(121/157) Batch: 1.103s | TOTAL: 2min | ETA: 1min | Loss: 0.1961 | Acc_t:  0.9088 | IOU_t:  0.8541 | IOU_k:  0.8476
(141/157) Batch: 1.103s | TOTAL: 3min | ETA: 0min | Loss: 0.1910 | Acc_t:  0.9101 | IOU_t:  0.8562 | IOU_k:  0.8493

Epoch: [11 | 30] LR: 0.000010
(1/157) Batch: 3.014s | TOTAL: 0min | ETA: 8min | Loss: 0.0998 | Acc_t:  0.9464 | IOU_t:  0.8473 | IOU_k:  0.8896
(21/157) Batch: 1.191s | TOTAL: 0min | ETA: 3min | Loss: 0.1782 | Acc_t:  0.9104 | IOU_t:  0.8506 | IOU_k:  0.8442
(41/157) Batch: 1.143s | TOTAL: 1min | ETA: 2min | Loss: 0.1827 | Acc_t:  0.9133 | IOU_t:  0.8555 | IOU_k:  0.8481
(61/157) Batch: 1.128s | TOTAL: 1min | ETA: 2min | Loss: 0.1887 | Acc_t:  0.9074 | IOU_t:  0.8504 | IOU_k:  0.8474
(81/157) Batch: 1.118s | TOTAL: 1min | ETA: 1min | Loss: 0.1869 | Acc_t:  0.9032 | IOU_t:  0.8480 | IOU_k:  0.8479
(101/157) Batch: 1.116s | TOTAL: 2min | ETA: 1min | Loss: 0.1928 | Acc_t:  0.9042 | IOU_t:  0.8476 | IOU_k:  0.8510
(121/157) Batch: 1.112s | TOTAL: 2min | ETA: 1min | Loss: 0.1977 | Acc_t:  0.9027 | IOU_t:  0.8454 | IOU_k:  0.8483
(141/157) Batch: 1.110s | TOTAL: 3min | ETA: 0min | Loss: 0.1901 | Acc_t:  0.9060 | IOU_t:  0.8489 | IOU_k:  0.8497

Epoch: [12 | 30] LR: 0.000010
(1/157) Batch: 2.692s | TOTAL: 0min | ETA: 7min | Loss: 0.1295 | Acc_t:  0.8901 | IOU_t:  0.8346 | IOU_k:  0.8016
(21/157) Batch: 1.179s | TOTAL: 0min | ETA: 3min | Loss: 0.2164 | Acc_t:  0.9010 | IOU_t:  0.8343 | IOU_k:  0.8409
(41/157) Batch: 1.138s | TOTAL: 1min | ETA: 2min | Loss: 0.2029 | Acc_t:  0.9130 | IOU_t:  0.8526 | IOU_k:  0.8524
(61/157) Batch: 1.125s | TOTAL: 1min | ETA: 2min | Loss: 0.2008 | Acc_t:  0.9110 | IOU_t:  0.8533 | IOU_k:  0.8516
Traceback (most recent call last):
  File "train_ic15.py", line 283, in <module>
    main(args)
  File "train_ic15.py", line 251, in main
    train_loss, train_te_acc, train_ke_acc, train_te_iou, train_ke_iou = train(train_loader, model, dice_loss, optimizer, epoch)
  File "train_ic15.py", line 112, in train
    for batch_idx, (imgs, gt_texts, gt_kernels, training_masks) in enumerate(train_loader):
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 345, in __next__
    data = self._next_data()
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 856, in _next_data
    return self._process_data(data)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 881, in _process_data
    data.reraise()
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/_utils.py", line 394, in reraise
    raise self.exc_type(msg)
AttributeError: Caught AttributeError in DataLoader worker process 2.
Original Traceback (most recent call last):
  File "/home/zhangyangsong/OCR/PSENet/dataset/icdar2015_loader.py", line 229, in __getitem__
    kernel_bboxes = shrink(bboxes, rate)
  File "/home/zhangyangsong/OCR/PSENet/dataset/icdar2015_loader.py", line 156, in shrink
    if shrinked_bbox.shape[0] <= 2:
AttributeError: 'list' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/utils/data/_utils/worker.py", line 178, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zhangyangsong/OCR/PSENet/dataset/icdar2015_loader.py", line 297, in __getitem__
    kernel_bboxes = shrink(bboxes, rate)
  File "/home/zhangyangsong/OCR/PSENet/dataset/icdar2015_loader.py", line 156, in shrink
    if shrinked_bbox.shape[0] <= 2:
AttributeError: 'list' object has no attribute 'shape'

checkpoint path: checkpoints/ic15_resnet50_bs_8_ep_30_pretrain_ic17
init lr: 0.00001000
schedule:  [10, 20]
Using pretrained model.

Epoch: [1 | 30] LR: 0.000010
/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/functional.py:2416: UserWarning: nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.
  warnings.warn("nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.")
/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/functional.py:2506: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  "See the documentation of nn.Upsample for details.".format(mode))
(1/157) Batch: 5.221s | TOTAL: 0min | ETA: 14min | Loss: 0.1840 | Acc_t:  0.8963 | IOU_t:  0.8562 | IOU_k:  0.8180
(21/157) Batch: 1.284s | TOTAL: 0min | ETA: 3min | Loss: 0.2247 | Acc_t:  0.8822 | IOU_t:  0.8301 | IOU_k:  0.8340
(41/157) Batch: 1.180s | TOTAL: 1min | ETA: 2min | Loss: 0.2562 | Acc_t:  0.8607 | IOU_t:  0.8056 | IOU_k:  0.8309
(61/157) Batch: 1.145s | TOTAL: 1min | ETA: 2min | Loss: 0.2442 | Acc_t:  0.8719 | IOU_t:  0.8155 | IOU_k:  0.8360
(81/157) Batch: 1.126s | TOTAL: 2min | ETA: 1min | Loss: 0.2381 | Acc_t:  0.8765 | IOU_t:  0.8181 | IOU_k:  0.8377
(101/157) Batch: 1.116s | TOTAL: 2min | ETA: 1min | Loss: 0.2359 | Acc_t:  0.8784 | IOU_t:  0.8190 | IOU_k:  0.8377
(121/157) Batch: 1.109s | TOTAL: 2min | ETA: 1min | Loss: 0.2354 | Acc_t:  0.8795 | IOU_t:  0.8206 | IOU_k:  0.8411
(141/157) Batch: 1.102s | TOTAL: 3min | ETA: 0min | Loss: 0.2430 | Acc_t:  0.8822 | IOU_t:  0.8201 | IOU_k:  0.8405
Traceback (most recent call last):
  File "train_ic15.py", line 283, in <module>
    main(args)
  File "train_ic15.py", line 257, in main
    }, checkpoint=args.checkpoint)
  File "train_ic15.py", line 180, in save_checkpoint
    torch.save(state, filepath)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/serialization.py", line 327, in save
    with _open_file_like(f, 'wb') as opened_file:
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/serialization.py", line 212, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/serialization.py", line 193, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: 'checkpoints/ic15_resnet50_bs_8_ep_30_pretrain_ic17/checkpoint.pth.tar'
checkpoint path: checkpoints/ic15_resnet50_bs_8_ep_30_pretrain_ic17
init lr: 0.00001000
schedule:  [10, 20]
Using pretrained model.

Epoch: [1 | 30] LR: 0.000010
/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/functional.py:2416: UserWarning: nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.
  warnings.warn("nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.")
/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/functional.py:2506: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  "See the documentation of nn.Upsample for details.".format(mode))
(1/157) Batch: 5.476s | TOTAL: 0min | ETA: 14min | Loss: 0.2357 | Acc_t:  0.9478 | IOU_t:  0.8995 | IOU_k:  0.8830
(21/157) Batch: 1.275s | TOTAL: 0min | ETA: 3min | Loss: 0.2064 | Acc_t:  0.9119 | IOU_t:  0.8404 | IOU_k:  0.8504
Traceback (most recent call last):
  File "train_ic15.py", line 283, in <module>
    main(args)
  File "train_ic15.py", line 251, in main
    train_loss, train_te_acc, train_ke_acc, train_te_iou, train_ke_iou = train(train_loader, model, dice_loss, optimizer, epoch)
  File "train_ic15.py", line 112, in train
    for batch_idx, (imgs, gt_texts, gt_kernels, training_masks) in enumerate(train_loader):
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 345, in __next__
    data = self._next_data()
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 856, in _next_data
    return self._process_data(data)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 881, in _process_data
    data.reraise()
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/_utils.py", line 394, in reraise
    raise self.exc_type(msg)
AttributeError: Caught AttributeError in DataLoader worker process 1.
Original Traceback (most recent call last):
  File "/home/zhangyangsong/OCR/PSENet/dataset/icdar2015_loader.py", line 229, in __getitem__
    kernel_bboxes = shrink(bboxes, rate)
  File "/home/zhangyangsong/OCR/PSENet/dataset/icdar2015_loader.py", line 156, in shrink
    if shrinked_bbox.shape[0] <= 2:
AttributeError: 'list' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/utils/data/_utils/worker.py", line 178, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zhangyangsong/OCR/PSENet/dataset/icdar2015_loader.py", line 297, in __getitem__
    kernel_bboxes = shrink(bboxes, rate)
  File "/home/zhangyangsong/OCR/PSENet/dataset/icdar2015_loader.py", line 156, in shrink
    if shrinked_bbox.shape[0] <= 2:
AttributeError: 'list' object has no attribute 'shape'

checkpoint path: checkpoints/ic15_resnet50_bs_8_ep_30_pretrain_ic17
init lr: 0.00001000
schedule:  [10, 20]
Using pretrained model.

Epoch: [1 | 30] LR: 0.000010
/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/functional.py:2416: UserWarning: nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.
  warnings.warn("nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.")
/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/functional.py:2506: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  "See the documentation of nn.Upsample for details.".format(mode))
(1/157) Batch: 6.179s | TOTAL: 0min | ETA: 16min | Loss: 0.0945 | Acc_t:  0.9197 | IOU_t:  0.8749 | IOU_k:  0.8720
(21/157) Batch: 1.305s | TOTAL: 0min | ETA: 3min | Loss: 0.1899 | Acc_t:  0.9234 | IOU_t:  0.8575 | IOU_k:  0.8641
(41/157) Batch: 1.193s | TOTAL: 1min | ETA: 2min | Loss: 0.1966 | Acc_t:  0.9283 | IOU_t:  0.8660 | IOU_k:  0.8624
(61/157) Batch: 1.160s | TOTAL: 1min | ETA: 2min | Loss: 0.1871 | Acc_t:  0.9245 | IOU_t:  0.8668 | IOU_k:  0.8573
(81/157) Batch: 1.142s | TOTAL: 2min | ETA: 1min | Loss: 0.1889 | Acc_t:  0.9225 | IOU_t:  0.8649 | IOU_k:  0.8573
(101/157) Batch: 1.130s | TOTAL: 2min | ETA: 1min | Loss: 0.1893 | Acc_t:  0.9194 | IOU_t:  0.8612 | IOU_k:  0.8579
(121/157) Batch: 1.121s | TOTAL: 2min | ETA: 1min | Loss: 0.1930 | Acc_t:  0.9177 | IOU_t:  0.8584 | IOU_k:  0.8574
(141/157) Batch: 1.116s | TOTAL: 3min | ETA: 0min | Loss: 0.1859 | Acc_t:  0.9170 | IOU_t:  0.8589 | IOU_k:  0.8558

Epoch: [2 | 30] LR: 0.000010
(1/157) Batch: 2.323s | TOTAL: 0min | ETA: 6min | Loss: 0.1105 | Acc_t:  0.8556 | IOU_t:  0.7974 | IOU_k:  0.7860
(21/157) Batch: 1.144s | TOTAL: 0min | ETA: 3min | Loss: 0.1711 | Acc_t:  0.9061 | IOU_t:  0.8563 | IOU_k:  0.8571
(41/157) Batch: 1.120s | TOTAL: 1min | ETA: 2min | Loss: 0.1631 | Acc_t:  0.9161 | IOU_t:  0.8645 | IOU_k:  0.8550
(61/157) Batch: 1.107s | TOTAL: 1min | ETA: 2min | Loss: 0.1551 | Acc_t:  0.9179 | IOU_t:  0.8631 | IOU_k:  0.8561
(81/157) Batch: 1.102s | TOTAL: 1min | ETA: 1min | Loss: 0.1764 | Acc_t:  0.9163 | IOU_t:  0.8595 | IOU_k:  0.8561
(101/157) Batch: 1.095s | TOTAL: 2min | ETA: 1min | Loss: 0.1871 | Acc_t:  0.9140 | IOU_t:  0.8588 | IOU_k:  0.8540
(121/157) Batch: 1.094s | TOTAL: 2min | ETA: 1min | Loss: 0.1949 | Acc_t:  0.9150 | IOU_t:  0.8583 | IOU_k:  0.8547
(141/157) Batch: 1.091s | TOTAL: 3min | ETA: 0min | Loss: 0.1927 | Acc_t:  0.9176 | IOU_t:  0.8615 | IOU_k:  0.8561

Epoch: [3 | 30] LR: 0.000010
(1/157) Batch: 3.085s | TOTAL: 0min | ETA: 8min | Loss: 0.3029 | Acc_t:  0.9184 | IOU_t:  0.8610 | IOU_k:  0.8574
(21/157) Batch: 1.190s | TOTAL: 0min | ETA: 3min | Loss: 0.1937 | Acc_t:  0.8870 | IOU_t:  0.8353 | IOU_k:  0.8449
(41/157) Batch: 1.134s | TOTAL: 1min | ETA: 2min | Loss: 0.1953 | Acc_t:  0.9069 | IOU_t:  0.8564 | IOU_k:  0.8490
(61/157) Batch: 1.120s | TOTAL: 1min | ETA: 2min | Loss: 0.1823 | Acc_t:  0.9119 | IOU_t:  0.8628 | IOU_k:  0.8533
(81/157) Batch: 1.113s | TOTAL: 1min | ETA: 1min | Loss: 0.1868 | Acc_t:  0.9128 | IOU_t:  0.8620 | IOU_k:  0.8532
(101/157) Batch: 1.108s | TOTAL: 2min | ETA: 1min | Loss: 0.1815 | Acc_t:  0.9145 | IOU_t:  0.8620 | IOU_k:  0.8529
(121/157) Batch: 1.105s | TOTAL: 2min | ETA: 1min | Loss: 0.1844 | Acc_t:  0.9147 | IOU_t:  0.8606 | IOU_k:  0.8536
(141/157) Batch: 1.104s | TOTAL: 3min | ETA: 0min | Loss: 0.1835 | Acc_t:  0.9155 | IOU_t:  0.8609 | IOU_k:  0.8528

Epoch: [4 | 30] LR: 0.000010
(1/157) Batch: 3.830s | TOTAL: 0min | ETA: 10min | Loss: 0.2025 | Acc_t:  0.9105 | IOU_t:  0.8606 | IOU_k:  0.8471
(21/157) Batch: 1.221s | TOTAL: 0min | ETA: 3min | Loss: 0.2241 | Acc_t:  0.9086 | IOU_t:  0.8540 | IOU_k:  0.8470
(41/157) Batch: 1.156s | TOTAL: 1min | ETA: 2min | Loss: 0.1902 | Acc_t:  0.9172 | IOU_t:  0.8656 | IOU_k:  0.8503
(61/157) Batch: 1.137s | TOTAL: 1min | ETA: 2min | Loss: 0.1800 | Acc_t:  0.9198 | IOU_t:  0.8679 | IOU_k:  0.8518


checkpoint path: checkpoints/ic15_resnet50_bs_8_ep_30_pretrain_ic17
init lr: 0.00000100
schedule:  [10, 20]
Using pretrained model.

Epoch: [1 | 30] LR: 0.000001
/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/functional.py:2416: UserWarning: nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.
  warnings.warn("nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.")
/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/functional.py:2506: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  "See the documentation of nn.Upsample for details.".format(mode))
(1/157) Batch: 6.226s | TOTAL: 0min | ETA: 16min | Loss: 0.1918 | Acc_t:  0.9438 | IOU_t:  0.8694 | IOU_k:  0.8757
(21/157) Batch: 1.317s | TOTAL: 0min | ETA: 3min | Loss: 0.1913 | Acc_t:  0.9259 | IOU_t:  0.8515 | IOU_k:  0.8534
(41/157) Batch: 1.200s | TOTAL: 1min | ETA: 2min | Loss: 0.1776 | Acc_t:  0.9316 | IOU_t:  0.8689 | IOU_k:  0.8512
(61/157) Batch: 1.160s | TOTAL: 1min | ETA: 2min | Loss: 0.1840 | Acc_t:  0.9291 | IOU_t:  0.8680 | IOU_k:  0.8525
(81/157) Batch: 1.137s | TOTAL: 2min | ETA: 1min | Loss: 0.1920 | Acc_t:  0.9264 | IOU_t:  0.8653 | IOU_k:  0.8543
(101/157) Batch: 1.125s | TOTAL: 2min | ETA: 1min | Loss: 0.1930 | Acc_t:  0.9247 | IOU_t:  0.8619 | IOU_k:  0.8518
(121/157) Batch: 1.118s | TOTAL: 2min | ETA: 1min | Loss: 0.1880 | Acc_t:  0.9238 | IOU_t:  0.8636 | IOU_k:  0.8507
(141/157) Batch: 1.113s | TOTAL: 3min | ETA: 0min | Loss: 0.1856 | Acc_t:  0.9254 | IOU_t:  0.8664 | IOU_k:  0.8540

Epoch: [2 | 30] LR: 0.000001
(1/157) Batch: 3.250s | TOTAL: 0min | ETA: 9min | Loss: 0.2264 | Acc_t:  0.9458 | IOU_t:  0.8751 | IOU_k:  0.8893
(21/157) Batch: 1.185s | TOTAL: 0min | ETA: 3min | Loss: 0.2250 | Acc_t:  0.9289 | IOU_t:  0.8664 | IOU_k:  0.8657
(41/157) Batch: 1.130s | TOTAL: 1min | ETA: 2min | Loss: 0.1967 | Acc_t:  0.9303 | IOU_t:  0.8730 | IOU_k:  0.8633
(61/157) Batch: 1.115s | TOTAL: 1min | ETA: 2min | Loss: 0.1911 | Acc_t:  0.9274 | IOU_t:  0.8699 | IOU_k:  0.8638
(81/157) Batch: 1.109s | TOTAL: 1min | ETA: 1min | Loss: 0.1950 | Acc_t:  0.9259 | IOU_t:  0.8698 | IOU_k:  0.8614
(101/157) Batch: 1.105s | TOTAL: 2min | ETA: 1min | Loss: 0.1864 | Acc_t:  0.9248 | IOU_t:  0.8709 | IOU_k:  0.8594
(121/157) Batch: 1.104s | TOTAL: 2min | ETA: 1min | Loss: 0.1814 | Acc_t:  0.9236 | IOU_t:  0.8704 | IOU_k:  0.8574
(141/157) Batch: 1.101s | TOTAL: 3min | ETA: 0min | Loss: 0.1782 | Acc_t:  0.9204 | IOU_t:  0.8675 | IOU_k:  0.8558

Epoch: [3 | 30] LR: 0.000001
(1/157) Batch: 4.497s | TOTAL: 0min | ETA: 12min | Loss: 0.5285 | Acc_t:  0.8909 | IOU_t:  0.8003 | IOU_k:  0.8845
(21/157) Batch: 1.262s | TOTAL: 0min | ETA: 3min | Loss: 0.2128 | Acc_t:  0.9159 | IOU_t:  0.8611 | IOU_k:  0.8667
(41/157) Batch: 1.180s | TOTAL: 1min | ETA: 2min | Loss: 0.1967 | Acc_t:  0.9210 | IOU_t:  0.8680 | IOU_k:  0.8594
(61/157) Batch: 1.150s | TOTAL: 1min | ETA: 2min | Loss: 0.1997 | Acc_t:  0.9190 | IOU_t:  0.8611 | IOU_k:  0.8562
(81/157) Batch: 1.133s | TOTAL: 2min | ETA: 1min | Loss: 0.2079 | Acc_t:  0.9188 | IOU_t:  0.8613 | IOU_k:  0.8546
(101/157) Batch: 1.123s | TOTAL: 2min | ETA: 1min | Loss: 0.2011 | Acc_t:  0.9183 | IOU_t:  0.8612 | IOU_k:  0.8538
(121/157) Batch: 1.116s | TOTAL: 2min | ETA: 1min | Loss: 0.1976 | Acc_t:  0.9200 | IOU_t:  0.8646 | IOU_k:  0.8543
(141/157) Batch: 1.111s | TOTAL: 3min | ETA: 0min | Loss: 0.2003 | Acc_t:  0.9202 | IOU_t:  0.8646 | IOU_k:  0.8547

Epoch: [4 | 30] LR: 0.000001
(1/157) Batch: 3.504s | TOTAL: 0min | ETA: 9min | Loss: 0.2950 | Acc_t:  0.9312 | IOU_t:  0.8815 | IOU_k:  0.8444
(21/157) Batch: 1.209s | TOTAL: 0min | ETA: 3min | Loss: 0.1893 | Acc_t:  0.9291 | IOU_t:  0.8806 | IOU_k:  0.8560
(41/157) Batch: 1.152s | TOTAL: 1min | ETA: 2min | Loss: 0.1814 | Acc_t:  0.9180 | IOU_t:  0.8669 | IOU_k:  0.8499
(61/157) Batch: 1.135s | TOTAL: 1min | ETA: 2min | Loss: 0.1806 | Acc_t:  0.9111 | IOU_t:  0.8604 | IOU_k:  0.8463
(81/157) Batch: 1.124s | TOTAL: 1min | ETA: 1min | Loss: 0.1784 | Acc_t:  0.9138 | IOU_t:  0.8615 | IOU_k:  0.8490
(101/157) Batch: 1.115s | TOTAL: 2min | ETA: 1min | Loss: 0.1754 | Acc_t:  0.9152 | IOU_t:  0.8640 | IOU_k:  0.8491
(121/157) Batch: 1.111s | TOTAL: 2min | ETA: 1min | Loss: 0.1710 | Acc_t:  0.9175 | IOU_t:  0.8676 | IOU_k:  0.8507
(141/157) Batch: 1.108s | TOTAL: 3min | ETA: 0min | Loss: 0.1738 | Acc_t:  0.9172 | IOU_t:  0.8670 | IOU_k:  0.8506

Epoch: [5 | 30] LR: 0.000001
(1/157) Batch: 4.188s | TOTAL: 0min | ETA: 11min | Loss: 0.1628 | Acc_t:  0.9545 | IOU_t:  0.9015 | IOU_k:  0.9036
(21/157) Batch: 1.241s | TOTAL: 0min | ETA: 3min | Loss: 0.1802 | Acc_t:  0.9258 | IOU_t:  0.8710 | IOU_k:  0.8620
(41/157) Batch: 1.168s | TOTAL: 1min | ETA: 2min | Loss: 0.1678 | Acc_t:  0.9260 | IOU_t:  0.8718 | IOU_k:  0.8588
(61/157) Batch: 1.139s | TOTAL: 1min | ETA: 2min | Loss: 0.1778 | Acc_t:  0.9228 | IOU_t:  0.8681 | IOU_k:  0.8579
(81/157) Batch: 1.128s | TOTAL: 2min | ETA: 1min | Loss: 0.1766 | Acc_t:  0.9171 | IOU_t:  0.8641 | IOU_k:  0.8560
(101/157) Batch: 1.122s | TOTAL: 2min | ETA: 1min | Loss: 0.1742 | Acc_t:  0.9200 | IOU_t:  0.8681 | IOU_k:  0.8554
(121/157) Batch: 1.117s | TOTAL: 2min | ETA: 1min | Loss: 0.1706 | Acc_t:  0.9190 | IOU_t:  0.8671 | IOU_k:  0.8543
(141/157) Batch: 1.117s | TOTAL: 3min | ETA: 0min | Loss: 0.1721 | Acc_t:  0.9170 | IOU_t:  0.8643 | IOU_k:  0.8531

Epoch: [6 | 30] LR: 0.000001
(1/157) Batch: 3.795s | TOTAL: 0min | ETA: 10min | Loss: 0.1010 | Acc_t:  0.9312 | IOU_t:  0.8944 | IOU_k:  0.8672
(21/157) Batch: 1.228s | TOTAL: 0min | ETA: 3min | Loss: 0.1671 | Acc_t:  0.9048 | IOU_t:  0.8536 | IOU_k:  0.8383
(41/157) Batch: 1.167s | TOTAL: 1min | ETA: 2min | Loss: 0.1520 | Acc_t:  0.9084 | IOU_t:  0.8536 | IOU_k:  0.8436
(61/157) Batch: 1.139s | TOTAL: 1min | ETA: 2min | Loss: 0.1771 | Acc_t:  0.9137 | IOU_t:  0.8595 | IOU_k:  0.8505
(81/157) Batch: 1.127s | TOTAL: 2min | ETA: 1min | Loss: 0.1771 | Acc_t:  0.9137 | IOU_t:  0.8589 | IOU_k:  0.8522
(101/157) Batch: 1.120s | TOTAL: 2min | ETA: 1min | Loss: 0.1801 | Acc_t:  0.9166 | IOU_t:  0.8611 | IOU_k:  0.8544
(121/157) Batch: 1.117s | TOTAL: 2min | ETA: 1min | Loss: 0.1771 | Acc_t:  0.9161 | IOU_t:  0.8617 | IOU_k:  0.8539
(141/157) Batch: 1.115s | TOTAL: 3min | ETA: 0min | Loss: 0.1769 | Acc_t:  0.9153 | IOU_t:  0.8606 | IOU_k:  0.8528

Epoch: [7 | 30] LR: 0.000001
(1/157) Batch: 3.516s | TOTAL: 0min | ETA: 9min | Loss: 0.2681 | Acc_t:  0.8653 | IOU_t:  0.8122 | IOU_k:  0.8005
(21/157) Batch: 1.205s | TOTAL: 0min | ETA: 3min | Loss: 0.2066 | Acc_t:  0.9207 | IOU_t:  0.8672 | IOU_k:  0.8570
(41/157) Batch: 1.152s | TOTAL: 1min | ETA: 2min | Loss: 0.1826 | Acc_t:  0.9232 | IOU_t:  0.8696 | IOU_k:  0.8562
(61/157) Batch: 1.128s | TOTAL: 1min | ETA: 2min | Loss: 0.1899 | Acc_t:  0.9202 | IOU_t:  0.8663 | IOU_k:  0.8550
(81/157) Batch: 1.116s | TOTAL: 1min | ETA: 1min | Loss: 0.1930 | Acc_t:  0.9179 | IOU_t:  0.8645 | IOU_k:  0.8529
(101/157) Batch: 1.115s | TOTAL: 2min | ETA: 1min | Loss: 0.1841 | Acc_t:  0.9179 | IOU_t:  0.8661 | IOU_k:  0.8528
